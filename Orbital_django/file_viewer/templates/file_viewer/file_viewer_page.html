<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style type="text/css">
            html, body {
                height: 100%;
                padding: 0;
                margin: 0;
            }
            #fileViewer {
                overflow: auto;
                text-align: center;
                float: left;
            } 
            #commentsViewer {
                float: left;
                border-style: solid;
                border-width: 1px;
                overflow: auto;
            }
            #resizeButton {
                margin-right: 18px;
                float: right;
            }
            #navbar {
                height: 24px;
                width: 100%;
            }
        </style>

        <!--JQUERY CDN-->
        <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.2.3.min.js" type="text/javascript"></script>
    </head>
    
    <body>
        <div id="navbar">
            <div id="resizeButton">
                <button type="button" id="buttonForLarger">+</button>
                <button type="button" id="buttonForSmaller">-</button>
            </div>
        </div>

        <div id="wrapper">
            <div id="fileViewer">
                {% for page in pages %}
                    <img class="Page" src={{ page }}> <br>
                {% endfor %}
            </div>

            <div id="commentsViewer">
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
                <h1>wocao</h1>
            </div>

            <div style="float: left; border-style: solid; border-width: 1px; overflow: auto; height: 240px; width: 380px;">
                {% for comment in document.comment_set.all %}
                    <p> {{ comment.content|safe }} </p>
                    <h5> {{ comment.commenter }} </h5>
                    <h5> {{ comment.post_time }} </h5>
                {% endfor %}
                <form id="comment_form">
                    <input type="text" name="comment_content">
                    <!--i use ajax to submit instead of using submit button-->
                    <button id="submit_button" type="button" name="document_id" value={{ document.id }}>comment</button>
                </form>
            </div>


        </div>


        <script type="text/javascript">

            $("#comment_form").children("button").click(function() {
                $.ajax({
                    type: "POST",
                    url: "file_viewer",
                    data: {
                        csrfmiddlewaretoken: {{ csrf_token }},
                        comment_content: $("input[name='comment_content']").val(),
                        document_id: $("botton[name='document_id']").val(),
                    },
                    success: function() {
                        alert("nice");
                    },
                })
            });

            $("#buttonForLarger").click(function(){
                $(".Page").css("width", parseInt($(".Page").css("width")) + 80 + "px");         
            });
            $("#buttonForSmaller").click(function(){
                $(".Page").css("width", parseInt($(".Page").css("width")) - 80 + "px");         
            });

            $(document).ready(function(){
                //设置wrapper的高度
                $("#wrapper").css("height", document.body.clientHeight - 24 + "px"); //jquery的css方法既可以设置css内容又可以获取css内容
                //设置fileViewer的高度和宽度
                $("#fileViewer").css("height", parseInt($("#wrapper").css("height")) + "px"); 
                $("#fileViewer").css("width", parseInt($("#wrapper").css("width")) * 0.6 + "px"); //jquery的css方法获得的是字符串，用js的parseInt获取数值
                //设置commentsViewer的高度和宽度
                $("#commentsViewer").css("height", parseInt($("#wrapper").css("height")) * 0.6 + "px"); 
                $("#commentsViewer").css("width", parseInt($("#wrapper").css("width")) - parseInt($("#fileViewer").css("width")) - 2 + "px");
                //设置文档的大小
                $(".Page").css("width", parseInt($("#fileViewer").css("width")) - 24 + "px"); 
            });
            $(window).resize(function(){
                $("#wrapper").css("height", document.body.clientHeight - 24 + "px");
                $("#fileViewer").css("height", parseInt($("#wrapper").css("height")) + "px"); 
                $("#fileViewer").css("width", parseInt($("#wrapper").css("width")) * 0.6 + "px");
                $("#commentsViewer").css("height", parseInt($("#wrapper").css("height")) * 0.6 + "px"); 
                $("#commentsViewer").css("width", parseInt($("#wrapper").css("width")) - parseInt($("#fileViewer").css("width")) - 2 + "px");
                //设置文档的大小
                $(".Page").css("width", parseInt($("#fileViewer").css("width")) - 24 + "px"); 
            });
        </script>
    </body>
</html>